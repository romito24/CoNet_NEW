<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>יצירת אירוע | CoNet</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="auth.css">
</head>

<body>

<div class="auth-wrapper">
  <div class="auth-container">

    <div class="auth-card">

        <h3 class="auth-heading">יצירת אירוע חדש</h3>
        <p class="auth-subtext">מלאי את פרטי האירוע עבור:</p>
        
        <h4 style="color: #4a90e2; margin-bottom: 5px; font-weight: bold;" id="spaceName">טוען שם מרחב...</h4>
        <p class="auth-subtext" id="spaceAddress" style="margin-bottom: 25px;">טוען כתובת...</p>

        <form id="eventForm">

            <input type="hidden" id="spaceId" name="spaceId">

            <div class="mb-3">
                <label>שם האירוע</label>
                <input
                    type="text"
                    id="eventName" 
                    class="form-control"
                    placeholder="לדוגמה: מפגש קהילה שבועי"
                    required
                >
            </div>

            <div class="mb-3">
                <label>קהילה משוייכת לאירוע</label>
                <select class="form-select" id="communityId" required>
                    <option value="" disabled selected>טוען קהילות בניהולך...</option>
                </select>
            </div>

            <div class="mb-3">
                <label>תאריך האירוע</label>
                <input
                    type="date"
                    id="eventDate"
                    class="form-control"
                    required
                >
            </div>

            <div class="d-flex gap-3 mb-3">
                <div class="flex-fill">
                    <label>שעת התחלה</label>
                    <input
                        type="time"
                        id="startHour"
                        class="form-control"
                        required
                    >
                </div>

                <div class="flex-fill">
                    <label>שעת סיום</label>
                    <input
                        type="time"
                        id="finishHour"
                        class="form-control"
                        required
                    >
                </div>
            </div>

            <div class="mb-4">
                <label>מספר משתתפים מקסימלי</label>
                <input
                    type="number"
                    id="maxParticipants"
                    class="form-control"
                    min="1"
                    placeholder="לדוגמה: 30"
                    required
                >
            </div>

            <button type="submit" class="auth-btn">
                יצירת אירוע
            </button>

        </form>

    </div>

  </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', async () => {
        // 1. שליפת הנתונים מהכתובת (URL)
        const params = new URLSearchParams(window.location.search);
        
        const spaceId = params.get('spaceId');
        const spaceName = params.get('spaceName');
        const spaceAddress = params.get('spaceAddress');

        // 2. הצגה מיידית של המידע
        if (spaceName) {
            const nameEl = document.getElementById('spaceName');
            if (nameEl) nameEl.innerText = spaceName;
        } else {
            document.getElementById('spaceName').innerText = "לא נבחר מרחב";
        }

        if (spaceAddress) {
            const addrEl = document.getElementById('spaceAddress');
            if (addrEl) addrEl.innerText = spaceAddress;
        } else {
            document.getElementById('spaceAddress').innerText = "";
        }

        // 3. מילוי השדה הנסתר והגנה
        if (spaceId) {
            document.getElementById('spaceId').value = spaceId;
        } else {
            alert("לא נבחר מרחב לאירוע. חוזר לחיפוש...");
            window.location.href = 'search.html';
        }
    });
</script>

<script src="new_event.js"></script>

</body>
</html>